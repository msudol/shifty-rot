<!doctype html>
<html lang="en">
<head>
    <title>Chosen Ciphertext Attack Challenge!</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'; img-src * data: 'unsafe-inline'; connect-src * 'unsafe-inline'; frame-src *;">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <!-- Don't bother trying to decrypt this javascript function, it will take longer than trying to solve the cipher -->
    <script type="text/javascript">function _0xa531(_0x4490e1,_0x218705){var _0x560e00=_0x560e();return _0xa531=function(_0xa531ce,_0x14e374){_0xa531ce=_0xa531ce-0xb4;var _0x1ca9c6=_0x560e00[_0xa531ce];return _0x1ca9c6;},_0xa531(_0x4490e1,_0x218705);}function _0x560e(){var _0x3b273e=['preventDefault','length','21371RrOoqk','8TLqbII','#cipherText','Python','#cipherForm','true','\x20!\x22#$%&\x27()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[]^_`abcdefghijklmnopqrstuvwxyz{|}~','136198TFfZRf','join','#resultText','from','JavaScript','indexOf','3PXjidS','toUpperCase','71160jwQzvW','1061092cxsXSq','627642pjupNU','push','1040PtGLif','3gpacAO','86801bCtZRb','645125KMtEtL'];_0x560e=function(){return _0x3b273e;};return _0x560e();}(function(_0x2939ec,_0x3de85a){var _0x702da6=_0xa531,_0x4805de=_0x2939ec();while(!![]){try{var _0x2c587d=parseInt(_0x702da6(0xb6))/0x1*(-parseInt(_0x702da6(0xc2))/0x2)+-parseInt(_0x702da6(0xc8))/0x3*(parseInt(_0x702da6(0xcb))/0x4)+-parseInt(_0x702da6(0xb8))/0x5+-parseInt(_0x702da6(0xca))/0x6+parseInt(_0x702da6(0xbb))/0x7*(parseInt(_0x702da6(0xbc))/0x8)+-parseInt(_0x702da6(0xcc))/0x9+-parseInt(_0x702da6(0xb5))/0xa*(-parseInt(_0x702da6(0xb7))/0xb);if(_0x2c587d===_0x3de85a)break;else _0x4805de['push'](_0x4805de['shift']());}catch(_0x584ea2){_0x4805de['push'](_0x4805de['shift']());}}}(_0x560e,0x230a4),$(function(){var _0x4eff89=_0xa531;$(_0x4eff89(0xbf))['submit'](function(_0x346542){var _0x3b4206=_0x4eff89;_0x346542[_0x3b4206(0xb9)]();var _0x21ba87=_0x3b4206(0xbe),_0x341f83=_0x3b4206(0xc6),_0x17005a=_0x3b4206(0xc1),_0x803961=$(_0x3b4206(0xbd))['val'](),_0x152b30=_0x3b4206(0xc0),_0x3ab28b=_0x3b4206(0xc0),_0x54cdd8='false',_0x276900=coder(_0x21ba87,_0x341f83,_0x17005a,_0x803961,_0x152b30,_0x3ab28b,_0x54cdd8);$(_0x3b4206(0xc4))['val'](_0x276900[0x0]);});}));const mod=(_0x4da345,_0x4d6fd3)=>(_0x4da345%_0x4d6fd3+_0x4d6fd3)%_0x4d6fd3;var coder=function(_0x5665a4,_0x3b24da,_0x276be8,_0x130522,_0x312a6e,_0x47c1b3,_0x16fd94){var _0x18e7df=_0xa531,_0x9a7a53=_0x312a6e==='true',_0x39f743=_0x47c1b3==='true',_0x53150b=_0x16fd94===_0x18e7df(0xc0);!_0x53150b&&(!_0x9a7a53&&(_0x130522=atob(_0x130522)));!_0x39f743&&(_0x276be8=_0x276be8[_0x18e7df(0xc9)](),_0x5665a4=_0x5665a4[_0x18e7df(0xc9)](),_0x3b24da=_0x3b24da[_0x18e7df(0xc9)]());var _0x414baa=Array[_0x18e7df(0xc5)](_0x276be8),_0x3d22c8=Array[_0x18e7df(0xc5)](_0x5665a4),_0x16c793=Array[_0x18e7df(0xc5)](_0x3b24da),_0x490d46=Array['from'](_0x130522);_0x3d22c8=keyCleaner(_0x3d22c8,_0x414baa),_0x16c793=keyCleaner(_0x16c793,_0x414baa);var _0x40f7c0=[],_0x14292e=[],_0x2d1974=_0x3d22c8['length'],_0x127c84=_0x16c793[_0x18e7df(0xba)];for(var _0x56fab4=0x0;_0x56fab4<_0x490d46[_0x18e7df(0xba)];_0x56fab4++){var _0x4ba461=_0x56fab4%_0x2d1974,_0x36f788=_0x56fab4%_0x127c84,_0x5dd48f;if(_0x39f743)var _0x5d74ba=_0x490d46[_0x56fab4];else var _0x5d74ba=_0x490d46[_0x56fab4][_0x18e7df(0xc9)]();_0x414baa[_0x18e7df(0xc7)](_0x5d74ba)>-0x1?_0x5dd48f=getRot(_0x3d22c8[_0x4ba461],_0x16c793[_0x36f788],_0x414baa,_0x490d46[_0x56fab4],_0x9a7a53,_0x39f743,_0x53150b):_0x5dd48f=[_0x490d46[_0x56fab4],'-'],_0x40f7c0[_0x18e7df(0xb4)](_0x5dd48f[0x0]),_0x14292e[_0x18e7df(0xb4)](_0x5dd48f[0x1]);}var _0x5c4464=_0x40f7c0[_0x18e7df(0xc3)]('');return!_0x53150b&&(_0x9a7a53&&(_0x5c4464=btoa(_0x5c4464))),[_0x5c4464,_0x14292e];};function keyCleaner(_0x4f8bf9,_0x5a51e6){var _0x5bd435=_0xa531;for(var _0x5db6da=_0x4f8bf9[_0x5bd435(0xba)];_0x5db6da>-0x1;_0x5db6da--){!_0x5a51e6['includes'](_0x4f8bf9[_0x5db6da])&&_0x4f8bf9['splice'](_0x5db6da,0x1);}return _0x4f8bf9;}function getRot(_0x2a3340,_0x18d7f9,_0x40d248,_0x505348,_0x51de08,_0x4a4bad,_0x11c937){var _0x208754=_0xa531,_0x38cf2a=_0x40d248[_0x208754(0xc7)](_0x2a3340),_0xdd1084=_0x40d248[_0x208754(0xc7)](_0x18d7f9);if(_0x4a4bad)var _0x3cc2a9=_0x40d248[_0x208754(0xc7)](_0x505348);else var _0x3cc2a9=_0x40d248[_0x208754(0xc7)](_0x505348[_0x208754(0xc9)]());var _0x42ec0d,_0x47a8e3,_0x203bfb;if(_0x38cf2a>_0xdd1084)_0x42ec0d=_0x40d248[_0x208754(0xba)]-_0x38cf2a+_0xdd1084;else _0x38cf2a<_0xdd1084?_0x42ec0d=_0xdd1084-_0x38cf2a:_0x42ec0d=0x0;return _0x51de08?_0x203bfb=mod(_0x3cc2a9+_0x42ec0d,_0x40d248[_0x208754(0xba)]):_0x203bfb=mod(_0x3cc2a9-_0x42ec0d,_0x40d248[_0x208754(0xba)]),_0x47a8e3=[_0x40d248[_0x203bfb],_0x42ec0d],_0x47a8e3;}</script>
</head>
<body>

<div class="container">
    <div class="row">

        <div class="col-sm-12">

            <h2>Chosen Ciphertext Attack Challenge!</h2>
            
            <p>Welcome to this chosen ciphertext challenge. Using this oracle, attempt to decode the ciphertext below by submitting your own messages and getting the return value.</p>
            
            <p>A chosen-ciphertext attack (CCA) is an attack model for cryptanalysis where the cryptanalyst can gather information by obtaining the decryptions of chosen ciphertexts. From these pieces of information the adversary can attempt to recover the hidden secret key used for decryption. </p>
            
            <p><b>Hint 1:</b> The cipher is a unique, unknown cipher that generates a pseudo-random encryption key using two keys of potentially variable length.</p>

            <p><b>Hint 2:</b> The encoder is capable of encoding messages containing alphanumeric and special character, is case-sensitive, and returns a base-64 encoded string.<p>

            <p><b>Hint 3:</b> For more clues, join the HackThisSite.org Discord Server and look for tremor.<p>

            <!-- <p><b>Hint 4:</b> Well done for looking at the source, so here is an extra hint...  consider the length of the result!<p> -->

            <div class="form-group">
                <label for="message">Secret Message:</label>
                <textarea readonly class="form-control" id="message" rows="1">PU9xYkdZQVhvLDxhRVBLZ3huKWpEeGplaEpyZmUmW0x2cElZMG9wdEpmK2dWZHdjP2tFcGxlI0psZSF6YlZ1XmRsK2Rke1BnUw==</textarea>
            </div>  
                 
            <form id="cipherForm" class="needs-validation" novalidate>
               
                <div class="form-group">
                    <label for="cipherText">Encoder:</label>
                    <textarea class="form-control" id="cipherText" rows="3">Try solving the ciphertext! Use this form to encode any message you like.</textarea>
                </div>  

                <div class="form-group">
                    <label for="resultText">Result Text: When this equals the secret message above, you have your answer!</label>
                    <textarea class="form-control" id="resultText" rows="3"></textarea>
                </div>  

                <button class="btn btn-primary" type="submit">Submit form</button>
              
            </form>
        </div>

    </div>
</div>

</body>

</html>